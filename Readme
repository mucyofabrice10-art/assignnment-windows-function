PL/SQL Window Functions & JOINs Project

Course: Database Development with PL/SQL (INSY 8311)
Student Name: Mucyo fabrice
Student ID: 29085
Instructor: Eric Maniraguha

```sql Business Problem

A retail analytics company wants to understand customer purchasing behavior across regions and time periods in order to improve product stocking, regional marketing strategies, and revenue forecasting.

The company faces difficulty identifying which products perform best in different regions, how sales evolve month-to-month, and how customers can be grouped based on their spending levels.

The expected outcome is to generate actionable insights that support management decisions related to promotions, inventory planning, and targeted customer campaigns.

 ##Success Criteria

This project aims to achieve the following five measurable analytical goals using window functions:

Identify the top five products per region or quarter using ranking functions.

Compute running monthly sales totals to track revenue trends over time.

Measure month-over-month sales growth using navigation functions.

Segment customers into four groups based on spending using quartiles.

Calculate three-month moving averages to smooth short-term fluctuations and reveal long-term patterns.

## Database Schema

The database consists of three related tables:

Customers

Stores customer information and geographic region.

Products

Contains product names, categories, and prices.

Transactions

Records purchase activity, including date, quantity, and associated customer and product.

Primary keys uniquely identify records in each table, while foreign keys enforce relationships between customers, products, and transactions.

## Entity Relationship Diagram (ERD)

(Insert ER diagram image here)

 Part A — SQL JOINs Implementation

This section demonstrates correct use of relational joins to answer business questions.

Implemented JOIN Types:

INNER JOIN — retrieves transactions with valid customers and products.

LEFT JOIN — identifies customers who have never made a purchase.

RIGHT or FULL JOIN — detects products that have no sales activity.

FULL OUTER JOIN — compares customers and products including unmatched records.

SELF JOIN — compares customers in the same region or transactions in similar time periods.

For each JOIN, the repository includes:

SQL query with comments

Screenshot of output

Business interpretation explaining the results

## Part B — Window Functions Implementation

This section applies analytical window functions to generate deeper insights.

Categories Covered:
1. Ranking Functions

Used to determine top-performing customers or products.
Functions include:

ROW_NUMBER()

RANK()

DENSE_RANK()

PERCENT_RANK()

2. Aggregate Window Functions

Used for trend analysis and running totals.
Functions include:

SUM()

AVG()

MIN()

MAX()
Frames include both ROWS and RANGE.

3. Navigation Functions

Used to compare values between periods.
Functions include:

LAG()

LEAD()

4. Distribution Functions

Used for customer segmentation.
Functions include:

NTILE(4)

CUME_DIST()

Each function is accompanied by:

SQL query with comments

Screenshot of results

Interpretation in 2–3 sentences

## Results Analysis
Descriptive Analysis — What Happened?

Sales were concentrated in a small number of top products, while several items showed low or no activity. Certain regions consistently generated higher revenue than others.

Diagnostic Analysis — Why Did It Happen?

Regional differences appear linked to customer volume and purchasing frequency. Product popularity and seasonal effects influenced revenue changes between months.

Prescriptive Analysis — What Should Be Done?

The company should increase inventory for high-performing products in strong regions, launch promotions for underperforming items, and design loyalty campaigns targeting high-value customer segments.

## Repository Contents

This GitHub repository contains:

SQL scripts for schema creation and queries

JOIN implementation queries

Window function queries

Screenshots of outputs

ER diagram

This README file

References

Integrity statement

## References

Oracle Database SQL Documentation

PostgreSQL Window Functions Guide

SQL Tutorial — Joins and Analytics

Course lecture materials

(Add full citations here.)

 Integrity Statement

“All sources were properly cited. Implementations and analysis represent original work. No AI-generated content was copied without attribution or adaptation.”

 ##Final Checklist

Repository is public

SQL scripts run without errors

Screenshots included

README is clear and professional

JOINs completed

Window functions implemented 

References included

Integrity statement added 
```
